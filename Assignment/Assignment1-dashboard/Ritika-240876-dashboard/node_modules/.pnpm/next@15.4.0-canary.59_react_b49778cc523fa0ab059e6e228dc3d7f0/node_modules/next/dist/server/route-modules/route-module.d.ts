import type { IncomingMessage, ServerResponse } from 'node:http';
import type { InstrumentationOnRequestError } from '../instrumentation/types';
import type { ParsedUrlQuery } from 'node:querystring';
import type { UrlWithParsedQuery } from 'node:url';
import type { PrerenderManifest, RequiredServerFilesManifest } from '../../build';
import type { DevRoutesManifest } from '../lib/router-utils/setup-dev-bundler';
import type { RouteDefinition } from '../route-definitions/route-definition';
import type { DeepReadonly } from '../../shared/lib/deep-readonly';
import type { PreviewData } from '../../types';
import type { BuildManifest } from '../get-page-files';
import type { ReactLoadableManifest } from '../load-components';
import type { NextFontManifest } from '../../build/webpack/plugins/next-font-manifest-plugin';
/**
 * RouteModuleOptions is the options that are passed to the route module, other
 * route modules should extend this class to add specific options for their
 * route.
 */
export interface RouteModuleOptions<D extends RouteDefinition = RouteDefinition, U = unknown> {
    readonly definition: Readonly<D>;
    readonly userland: Readonly<U>;
    readonly distDir: string;
    readonly projectDir: string;
}
/**
 * RouteHandlerContext is the base context for a route handler.
 */
export interface RouteModuleHandleContext {
    /**
     * Any matched parameters for the request. This is only defined for dynamic
     * routes.
     */
    params: Record<string, string | string[] | undefined> | undefined;
}
/**
 * RouteModule is the base class for all route modules. This class should be
 * extended by all route modules.
 */
export declare abstract class RouteModule<D extends RouteDefinition = RouteDefinition, U = unknown> {
    /**
     * The userland module. This is the module that is exported from the user's
     * code. This is marked as readonly to ensure that the module is not mutated
     * because the module (when compiled) only provides getters.
     */
    readonly userland: Readonly<U>;
    /**
     * The definition of the route.
     */
    readonly definition: Readonly<D>;
    /**
     * The shared modules that are exposed and required for the route module.
     */
    static readonly sharedModules: any;
    isDev: boolean;
    distDir: string;
    projectDir: string;
    constructor({ userland, definition, distDir, projectDir, }: RouteModuleOptions<D, U>);
    instrumentationOnRequestError(req: IncomingMessage, ...args: Parameters<InstrumentationOnRequestError>): Promise<void>;
    private loadManifests;
    prepare(req: IncomingMessage, res: ServerResponse, { srcPage, multiZoneDraftMode, }: {
        srcPage: string;
        multiZoneDraftMode?: boolean;
    }): Promise<{
        buildId: string;
        locale?: string;
        locales?: readonly string[];
        defaultLocale?: string;
        query: ParsedUrlQuery;
        originalQuery: ParsedUrlQuery;
        originalPathname: string;
        params?: ParsedUrlQuery;
        parsedUrl: UrlWithParsedQuery;
        previewData: PreviewData;
        isDraftMode: boolean;
        isNextDataRequest: boolean;
        buildManifest: DeepReadonly<BuildManifest>;
        nextFontManifest: DeepReadonly<NextFontManifest>;
        serverFilesManifest: DeepReadonly<RequiredServerFilesManifest>;
        reactLoadableManifest: DeepReadonly<ReactLoadableManifest>;
        routesManifest: DeepReadonly<DevRoutesManifest>;
        prerenderManifest: DeepReadonly<PrerenderManifest>;
        isOnDemandRevalidate: boolean;
        revalidateOnlyGenerated: boolean;
    } | undefined>;
}
