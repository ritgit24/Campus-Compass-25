{"version":3,"sources":["../../../src/client/react-client-callbacks/on-recoverable-error.ts"],"sourcesContent":["// This module can be shared between both pages router and app router\n\nimport type { HydrationOptions } from 'react-dom/client'\nimport { isBailoutToCSRError } from '../../shared/lib/lazy-dynamic/bailout-to-csr'\nimport {\n  setOwnerStackIfAvailable,\n  setComponentStack,\n  coerceError,\n} from '../components/errors/stitched-error'\nimport isError from '../../lib/is-error'\nimport { reportGlobalError } from './report-global-error'\n\nconst recoverableErrors = new WeakSet<Error>()\n\nexport function isRecoverableError(error: Error): boolean {\n  return recoverableErrors.has(error)\n}\n\nexport const onRecoverableError: HydrationOptions['onRecoverableError'] = (\n  error,\n  errorInfo\n) => {\n  // x-ref: https://github.com/facebook/react/pull/28736\n  const cause = isError(error) && 'cause' in error ? error.cause : error\n  // Skip certain custom errors which are not expected to be reported on client\n  if (isBailoutToCSRError(cause)) return\n\n  const causeError = coerceError(cause)\n  recoverableErrors.add(causeError)\n  setOwnerStackIfAvailable(causeError)\n\n  if (process.env.NODE_ENV === 'development' && errorInfo.componentStack) {\n    setComponentStack(causeError, errorInfo.componentStack)\n  }\n\n  reportGlobalError(causeError)\n}\n"],"names":["isBailoutToCSRError","setOwnerStackIfAvailable","setComponentStack","coerceError","isError","reportGlobalError","recoverableErrors","WeakSet","isRecoverableError","error","has","onRecoverableError","errorInfo","cause","causeError","add","process","env","NODE_ENV","componentStack"],"mappings":"AAAA,qEAAqE;AAGrE,SAASA,mBAAmB,QAAQ,+CAA8C;AAClF,SACEC,wBAAwB,EACxBC,iBAAiB,EACjBC,WAAW,QACN,sCAAqC;AAC5C,OAAOC,aAAa,qBAAoB;AACxC,SAASC,iBAAiB,QAAQ,wBAAuB;AAEzD,MAAMC,oBAAoB,IAAIC;AAE9B,OAAO,SAASC,mBAAmBC,KAAY;IAC7C,OAAOH,kBAAkBI,GAAG,CAACD;AAC/B;AAEA,OAAO,MAAME,qBAA6D,CACxEF,OACAG;IAEA,sDAAsD;IACtD,MAAMC,QAAQT,QAAQK,UAAU,WAAWA,QAAQA,MAAMI,KAAK,GAAGJ;IACjE,6EAA6E;IAC7E,IAAIT,oBAAoBa,QAAQ;IAEhC,MAAMC,aAAaX,YAAYU;IAC/BP,kBAAkBS,GAAG,CAACD;IACtBb,yBAAyBa;IAEzB,IAAIE,QAAQC,GAAG,CAACC,QAAQ,KAAK,iBAAiBN,UAAUO,cAAc,EAAE;QACtEjB,kBAAkBY,YAAYF,UAAUO,cAAc;IACxD;IAEAd,kBAAkBS;AACpB,EAAC","ignoreList":[0]}